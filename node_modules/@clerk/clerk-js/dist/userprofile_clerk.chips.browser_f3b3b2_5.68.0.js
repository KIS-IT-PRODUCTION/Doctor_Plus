"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["470"],{9140:function(e,t,r){r.d(t,{_:()=>b});var i=r(9109),o=r(3799),a=r(9144),l=r(2672),n=r(431),s=r(9460),c=r(8487),d=r(8969),u=r(111),h=r(1085),m=r(43),p=r(207),f=r(4676),g=r(6917),y=r(9541),v=r(2464);let P=e=>{let{navigate:t}=(0,f.useRouter)(),{email:r,nextStep:o,onReset:n}=e,c=(0,l.useCardState)(),d=(0,u.useUserProfileContext)(),{startEnterpriseSSOLinkFlow:h}=(0,v.eq)(r);async function p(){await t(r.verification.externalVerificationRedirectURL?.href||"")}return a.useEffect(()=>{!function(){let{mode:e,componentName:t}=d;h({redirectUrl:"modal"===e?(0,g.bX)({url:window.location.href,componentName:t}):window.location.href}).then(()=>o()).catch(e=>(0,m.S3)(e,[],c.setError))}()},[]),(0,i.BX)(i.HY,{children:[(0,i.tZ)(y.Flex,{justify:"center",children:(0,i.tZ)(y.Button,{variant:"link",onClick:p,localizationKey:(0,y.localizationKeys)("userProfile.emailAddressPage.enterpriseSSOLink.formButton")})}),(0,i.tZ)(s.K,{children:(0,i.tZ)(y.Button,{variant:"ghost",localizationKey:(0,y.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:y.descriptors.formButtonReset,onClick:n})})]})};var Z=r(2786);let b=(0,l.withCardStateProvider)(e=>{let{emailId:t,onSuccess:r,onReset:f,disableAutoFocus:g=!1}=e,y=(0,l.useCardState)(),{user:v}=(0,o.aF)(),b=(0,u.useEnvironment)(),C=(0,o.WZ)(e=>v?.createEmailAddress({email:e})),K=a.useRef(v?.emailAddresses.find(e=>e.id===t)),x=S(K.current,b),_=(0,d.a2)({defaultStep:+!!K.current,onNextStep:()=>y.setError(void 0)}),B=(0,m.Yp)("emailAddress","",{type:"email",label:(0,h.u1)("formFieldLabel__emailAddress"),placeholder:(0,h.u1)("formFieldInputPlaceholder__emailAddress"),isRequired:!0}),R=B.value.length>1&&v?.username!==B.value,w=async e=>{if(e.preventDefault(),v)return C(B.value).then(e=>{K.current=e,_.nextStep()}).catch(e=>(0,m.S3)(e,[B],y.setError))},k=z(x);return(0,i.BX)(d.en,{..._.props,children:[(0,i.tZ)(c.Y,{headerTitle:e.title||(0,h.u1)("userProfile.emailAddressPage.title"),headerSubtitle:e.subtitle||(0,h.u1)("userProfile.emailAddressPage.formHint"),children:(0,i.BX)(n.l.Root,{onSubmit:w,children:[(0,i.tZ)(n.l.ControlRow,{elementId:B.id,children:(0,i.tZ)(n.l.PlainInput,{...B.props,autoFocus:!g})}),(0,i.tZ)(s.A,{submitLabel:(0,h.u1)("userProfile.formButtonPrimary__add"),isDisabled:!R,onReset:f})]})}),(0,i.BX)(c.Y,{headerTitle:(0,h.u1)("userProfile.emailAddressPage.verifyTitle"),headerSubtitle:(0,h.u1)(`${k}.formSubtitle`,{identifier:K.current?.emailAddress}),children:["email_link"===x&&(0,i.tZ)(Z.K,{nextStep:r,email:K.current,onReset:f}),"email_code"===x&&(0,i.tZ)(p.H,{nextStep:r,identification:K.current,identifier:K.current?.emailAddress,prepareVerification:()=>K.current?.prepareVerification({strategy:"email_code"}),onReset:f}),"enterprise_sso"===x&&(0,i.tZ)(P,{nextStep:r,email:K.current,onReset:f})]})]})}),z=e=>{switch(e){case"email_code":return"userProfile.emailAddressPage.emailCode";case"enterprise_sso":return"userProfile.emailAddressPage.enterpriseSSOLink";case"email_link":return"userProfile.emailAddressPage.emailLink";default:throw Error(`Unsupported strategy for email verification: ${e}`)}},S=(e,t)=>e?.matchesSsoConnection?"enterprise_sso":!function(e){let{userSettings:t}=e,{email_address:r}=t.attributes;return!!(r?.enabled&&r?.verifications.includes("email_link"))}(t)?"email_code":"email_link"},207:function(e,t,r){r.d(t,{H:()=>u});var i=r(9109),o=r(9144),a=r(2667),l=r(2672),n=r(431),s=r(9460),c=r(9541),d=r(43);let u=e=>{let t=(0,l.useCardState)(),{nextStep:r,identification:u,identifier:h,onReset:m,prepareVerification:p}=e,f=()=>p?.()?.catch(e=>d.S3(e,[],t.setError)),g=(0,a.e3)({onCodeEntryFinished:(e,t,r)=>{u?.attemptVerification({code:e}).then(()=>t()).catch(r)},onResendCodeClicked:f,onResolve:r});return o.useEffect(()=>{f()},[]),(0,i.BX)(i.HY,{children:[(0,i.tZ)(n.l.OTPInput,{...g,label:(0,c.localizationKeys)("userProfile.emailAddressPage.emailCode.formTitle"),description:(0,c.localizationKeys)("userProfile.emailAddressPage.emailCode.formSubtitle",{identifier:h}),resendButton:(0,c.localizationKeys)("userProfile.emailAddressPage.emailCode.resendButton"),centerAlign:!1}),(0,i.BX)(s.K,{children:[(0,i.tZ)(c.Button,{isLoading:g.isLoading,localizationKey:(0,c.localizationKeys)("formButtonPrimary__verify"),elementDescriptor:c.descriptors.formButtonPrimary,onClick:g.onFakeContinue}),(0,i.tZ)(c.Button,{variant:"ghost",isDisabled:g.isLoading,localizationKey:(0,c.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:c.descriptors.formButtonReset,onClick:m})]})]})}},2786:function(e,t,r){r.d(t,{K:()=>p,M:()=>f});var i=r(9109),o=r(9144),a=r(2672),l=r(9460),n=r(5495),s=r(8969),c=r(6749),d=r(111),u=r(9541),h=r(2464),m=r(43);let p=e=>{let{email:t,nextStep:r,onReset:s}=e,p=(0,a.useCardState)(),f=(0,d.useUserProfileContext)(),{startEmailLinkFlow:g}=(0,h.E2)(t),{displayConfig:y}=(0,d.useEnvironment)();function v(){let{routing:e}=f,t="virtual"===e?y.userProfileUrl:"";g({redirectUrl:(0,c.Uu)({ctx:f,baseUrl:t,intent:"profile"})}).then(()=>r()).catch(e=>(0,m.S3)(e,[],p.setError))}return o.useEffect(()=>{v()},[]),(0,i.BX)(i.HY,{children:[(0,i.tZ)(n.V,{resendButton:(0,u.localizationKeys)("userProfile.emailAddressPage.emailLink.resendButton"),onResendCodeClicked:v}),(0,i.tZ)(l.K,{children:(0,i.tZ)(u.Button,{variant:"ghost",localizationKey:(0,u.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:u.descriptors.formButtonReset,onClick:s})})]})},f=()=>(0,i.tZ)(s.Ej,{title:(0,u.localizationKeys)("signUp.emailLink.verifiedSwitchTab.title"),subtitle:(0,u.localizationKeys)("signUp.emailLink.verifiedSwitchTab.subtitle"),status:"verified"})},6871:function(e,t,r){r.r(t),r.d(t,{UserProfile:()=>t_,UserProfileModal:()=>tB});var i=r(9109),o=r(9144),a=r(2672),l=r(5579),n=r(3394),s=r(1673),c=r(111),d=r(9541),u=r(4676),h=r(1085);let m=e=>{let{pages:t}=(0,c.useUserProfileContext)();return(0,i.BX)(l.Uh,{children:[(0,i.tZ)(l.l2,{title:(0,h.u1)("userProfile.navbar.title"),description:(0,h.u1)("userProfile.navbar.description"),routes:t.routes,contentRef:e.contentRef}),e.children]})};var p=r(4995),f=r(5515),g=r(3799),y=r(4455),v=r(2654),P=r(9655),Z=r(3009),b=r(6917),z=r(8969),S=r(9805),C=r(4709),K=r(2464),x=r(43);let _=e=>{let{strategy:t}=e,r=(0,a.useCardState)(),{user:o}=(0,g.aF)(),{navigate:l}=(0,u.useRouter)(),{strategyToDisplayData:n}=(0,K.vO)(),{additionalOAuthScopes:s,componentName:h,mode:m}=(0,c.useUserProfileContext)(),p="modal"===m,f=(0,g.WZ)(()=>{let e=t.replace("oauth_",""),r=p?(0,b.bX)({url:window.location.href,componentName:h,socialProvider:e}):window.location.href,i=s?s[e]:[];return o?.createExternalAccount({strategy:t,redirectUrl:r,additionalScopes:i})}),y=n[t].iconUrl?(0,i.tZ)(d.Image,{isLoading:r.loadingMetadata===t,isDisabled:r.isLoading,elementDescriptor:d.descriptors.providerIcon,elementId:d.descriptors.providerIcon.setId(n[t].id),src:n[t].iconUrl,alt:`Connect ${n[t].name} account`,sx:e=>({width:e.sizes.$4})}):(0,i.tZ)(z.e_,{id:n[t].id,value:n[t].name,isLoading:r.loadingMetadata===t,isDisabled:r.isLoading});return(0,i.tZ)(P.zd.ActionMenuItem,{id:n[t].id,onClick:()=>{if(o)return r.setLoading(t),f().then(e=>{e&&e.verification?.externalVerificationRedirectURL&&((0,x._v)(2e3).then(()=>r.setIdle(t)),l(e.verification.externalVerificationRedirectURL.href))}).catch(e=>{(0,x.S3)(e,[],r.setError),r.setIdle(t)})},isDisabled:r.isLoading,variant:"ghost",isLoading:r.loadingMetadata===t,focusRing:!1,closeAfterClick:!1,localizationKey:(0,d.localizationKeys)("userProfile.connectedAccountPage.socialButtonsBlockButton",{provider:n[t].name}),sx:e=>({justifyContent:"start",gap:e.space.$2}),leftIcon:y},t)},B=({onClick:e})=>{let{user:t}=(0,g.aF)(),{strategies:r}=(0,K.vO)(),o=r.filter(e=>e.startsWith("oauth")),a=t?.verifiedExternalAccounts.map(e=>`oauth_${e.provider}`),l=o.filter(e=>!a.includes(e));return 0===l.length?null:(0,i.tZ)(P.zd.ActionMenu,{triggerLocalizationKey:(0,d.localizationKeys)("userProfile.start.connectedAccountsSection.primaryButton"),id:"connectedAccounts",onClick:e,children:l.map(e=>(0,i.tZ)(_,{strategy:e},e))})},R=e=>{let{onSuccess:t,onReset:r}=e,{user:a}=(0,g.aF)(),{emailId:l}=e,n=a?.emailAddresses.find(e=>e.id===l),s=o.useRef(n?.emailAddress),c=n?.verification?.status==="verified"?(0,d.localizationKeys)("userProfile.emailAddressPage.removeResource.messageLine2"):void 0;return s.current?(0,i.tZ)(z.LE,{title:(0,d.localizationKeys)("userProfile.emailAddressPage.removeResource.title"),messageLine1:(0,d.localizationKeys)("userProfile.emailAddressPage.removeResource.messageLine1",{identifier:s.current}),messageLine2:c,successMessage:(0,d.localizationKeys)("userProfile.emailAddressPage.removeResource.successMessage",{emailAddress:s.current}),deleteResource:()=>Promise.resolve(n?.destroy()),onSuccess:t,onReset:r}):null},w=e=>{let{phoneId:t,onSuccess:r,onReset:a}=e,{user:l}=(0,g.aF)(),n=l?.phoneNumbers.find(e=>e.id===t),s=o.useRef(n?.phoneNumber),c=n?.verification?.status==="verified"?(0,d.localizationKeys)("userProfile.phoneNumberPage.removeResource.messageLine2"):void 0;return s.current?(0,i.tZ)(z.LE,{title:(0,d.localizationKeys)("userProfile.phoneNumberPage.removeResource.title"),messageLine1:(0,d.localizationKeys)("userProfile.phoneNumberPage.removeResource.messageLine1",{identifier:s.current}),messageLine2:c,successMessage:(0,d.localizationKeys)("userProfile.phoneNumberPage.removeResource.successMessage",{phoneNumber:s.current}),deleteResource:()=>Promise.resolve(n?.destroy()),onSuccess:r,onReset:a}):null},k=e=>{let{accountId:t,onSuccess:r,onReset:a}=e,{user:l}=(0,g.aF)(),n=l?.externalAccounts.find(e=>e.id===t),s=o.useRef(n?.provider),{providerToDisplayData:c}=(0,K.vO)();return s.current?(0,i.tZ)(z.LE,{title:(0,d.localizationKeys)("userProfile.connectedAccountPage.removeResource.title"),messageLine1:(0,d.localizationKeys)("userProfile.connectedAccountPage.removeResource.messageLine1",{identifier:c[s.current]?.name}),messageLine2:(0,d.localizationKeys)("userProfile.connectedAccountPage.removeResource.messageLine2"),successMessage:(0,d.localizationKeys)("userProfile.connectedAccountPage.removeResource.successMessage",{connectedAccount:c[s.current]?.name}),deleteResource:()=>Promise.resolve(n?.destroy()),onSuccess:r,onReset:a}):null},I=e=>{let{user:t}=(0,g.aF)(),{walletId:r,onSuccess:a,onReset:l}=e,n=t?.web3Wallets.find(e=>e.id===r),s=o.useRef(n?.web3Wallet),c=n?.verification?.status==="verified"?(0,d.localizationKeys)("userProfile.web3WalletPage.removeResource.messageLine2"):void 0;return s.current?(0,i.tZ)(z.LE,{title:(0,d.localizationKeys)("userProfile.web3WalletPage.removeResource.title"),messageLine1:(0,d.localizationKeys)("userProfile.web3WalletPage.removeResource.messageLine1",{identifier:s.current}),messageLine2:c,successMessage:(0,d.localizationKeys)("userProfile.web3WalletPage.removeResource.successMessage",{web3Wallet:s.current}),deleteResource:()=>Promise.resolve(n?.destroy()),onSuccess:a,onReset:l}):null},T=e=>{let{user:t}=(0,g.aF)(),{phoneId:r,onSuccess:a,onReset:l}=e,n=t?.phoneNumbers.find(e=>e.id===r),s=o.useRef(n?.phoneNumber);return s.current?(0,i.tZ)(z.LE,{title:(0,d.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.title"),messageLine1:(0,d.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.messageLine1",{identifier:s.current}),messageLine2:(0,d.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.messageLine2"),successMessage:(0,d.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.successMessage",{mfaPhoneCode:s.current}),deleteResource:()=>Promise.resolve(n?.setReservedForSecondFactor({reserved:!1})),onSuccess:a,onReset:l}):null},A=e=>{let{onSuccess:t,onReset:r}=e,{user:o}=(0,g.aF)();return o?(0,i.tZ)(z.LE,{title:(0,d.localizationKeys)("userProfile.mfaTOTPPage.removeResource.title"),messageLine1:(0,d.localizationKeys)("userProfile.mfaTOTPPage.removeResource.messageLine1"),messageLine2:(0,d.localizationKeys)("userProfile.mfaTOTPPage.removeResource.messageLine2"),successMessage:(0,d.localizationKeys)("userProfile.mfaTOTPPage.removeResource.successMessage"),deleteResource:o.disableTOTP,onSuccess:t,onReset:r}):null},X=e=>{let{onSuccess:t,onReset:r,passkey:o}=e;return(0,i.tZ)(z.LE,{title:(0,d.localizationKeys)("userProfile.passkeyScreen.removeResource.title"),messageLine1:(0,d.localizationKeys)("userProfile.passkeyScreen.removeResource.messageLine1",{name:o.name}),deleteResource:o.delete,onSuccess:t,onReset:r})},L=e=>{let{close:t}=(0,C.XC)();return(0,i.tZ)(k,{onSuccess:t,onReset:t,...e})},$=["external_account_missing_refresh_token","oauth_fetch_user_error","oauth_token_exchange_error","external_account_email_address_verification_required"],F=(0,a.withCardStateProvider)(({shouldAllowCreation:e=!0})=>{let{user:t}=(0,g.aF)(),r=(0,a.useCardState)(),l=!!t?.externalAccounts?.length,[n,s]=(0,o.useState)(null);if(!t||!e&&!l)return null;let c=[...t.verifiedExternalAccounts,...t.unverifiedExternalAccounts.filter(e=>e.verification?.error)];return(0,i.BX)(P.zd.Root,{title:(0,d.localizationKeys)("userProfile.start.connectedAccountsSection.title"),centered:!1,id:"connectedAccounts",children:[(0,i.tZ)(y.Z.Alert,{children:r.error}),(0,i.BX)(S.a.Root,{value:n,onChange:s,children:[(0,i.tZ)(P.zd.ItemList,{id:"connectedAccounts",children:c.map(e=>(0,i.tZ)(E,{account:e},e.id))}),e&&(0,i.tZ)(B,{onClick:()=>s(null)})]})]})}),E=({account:e})=>{let{additionalOAuthScopes:t,componentName:r,mode:l}=(0,c.useUserProfileContext)(),{navigate:n}=(0,u.useRouter)(),{user:s}=(0,g.aF)(),h=(0,a.useCardState)(),m=e.id,p="modal"===l,f=p?(0,b.bX)({url:window.location.href,componentName:r}):window.location.href,y=(0,g.WZ)(()=>s?.createExternalAccount({strategy:e.verification.strategy,redirectUrl:f,additionalScopes:_}));if(!s)return null;let{providerToDisplayData:v}=(0,K.vO)(),Z=e.username||e.emailAddress,C=e.verification?.error?.longMessage,_=function(e,t){if(!t)return[];let r=t[e.provider]||[],i=e.approvedScopes.split(" ");return 0===r.filter(e=>!i.includes(e)).length?[]:r}(e,t),B=_.length>0&&""!=e.approvedScopes,R=$.includes(e.verification?.error?.code||"")||B,w=R?(0,d.localizationKeys)("userProfile.start.connectedAccountsSection.subtitle__disconnected"):C,k=async()=>{let t=p?(0,b.bX)({url:window.location.href,componentName:r}):window.location.href;try{let r;(r=B?await e.reauthorize({additionalScopes:_,redirectUrl:t}):await y())&&await n(r.verification.externalVerificationRedirectURL?.href||"")}catch(e){(0,x.S3)(e,[],h.setError)}};return(0,i.BX)(o.Fragment,{children:[(0,i.BX)(P.zd.Item,{id:"connectedAccounts",children:[(0,i.BX)(d.Flex,{sx:e=>({overflow:"hidden",gap:e.space.$2}),children:[(0,i.tZ)(()=>v[e.provider].iconUrl?(0,i.tZ)(d.Image,{elementDescriptor:[d.descriptors.providerIcon],elementId:d.descriptors.socialButtonsProviderIcon.setId(e.provider),alt:v[e.provider].name,src:v[e.provider].iconUrl,sx:e=>({width:e.sizes.$4,flexShrink:0})}):(0,i.tZ)(z.e_,{id:e.provider,value:v[e.provider].name}),{}),(0,i.tZ)(d.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,i.BX)(d.Flex,{gap:1,center:!0,children:[(0,i.tZ)(d.Text,{sx:e=>({color:e.colors.$colorText}),children:`${v[e.provider].name}`}),(0,i.tZ)(d.Text,{truncate:!0,as:"span",colorScheme:"secondary",children:Z?`• ${Z}`:""})]})})]}),(0,i.tZ)(D,{account:e})]}),R&&(0,i.BX)(d.Box,{sx:e=>({padding:`${e.sizes.$none} ${e.sizes.$none} ${e.sizes.$1x5} ${e.sizes.$8x5}`}),children:[(0,i.tZ)(d.Text,{colorScheme:"secondary",sx:e=>({paddingRight:e.sizes.$1x5,display:"inline-block"}),localizationKey:w}),(0,i.tZ)(d.Button,{sx:{display:"inline-block"},onClick:k,variant:"link",localizationKey:(0,d.localizationKeys)("userProfile.start.connectedAccountsSection.actionLabel__connectionFailed")})]}),e.verification?.error?.code&&!R&&(0,i.tZ)(d.Text,{colorScheme:"danger",sx:e=>({padding:`${e.sizes.$none} ${e.sizes.$1x5} ${e.sizes.$1x5} ${e.sizes.$8x5}`}),children:C}),(0,i.tZ)(S.a.Open,{value:`remove-${m}`,children:(0,i.tZ)(S.a.Card,{variant:"destructive",children:(0,i.tZ)(L,{accountId:e.id})})})]},e.id)},D=({account:e})=>{let{open:t}=(0,C.XC)(),r=e.id,o=[{label:(0,d.localizationKeys)("userProfile.start.connectedAccountsSection.destructiveActionTitle"),isDestructive:!0,onClick:()=>t(`remove-${r}`)}].filter(e=>null!==e);return(0,i.tZ)(Z.a,{actions:o})},O=e=>t=>t.id===e?-1:1,N=e=>e.defaultSecondFactor?-1:1;function W(e){let t=[];return Object.entries(e).forEach(([,e])=>{e.used_for_second_factor&&t.push(...e.second_factors)}),t}function M(e,t){let r=W(e);return t.totpEnabled&&(r=r.filter(e=>"totp"!==e)),(t.backupCodeEnabled||!t.twoFactorEnabled)&&(r=r.filter(e=>"backup_code"!==e)),r}function U(e,t){if(!e)return[];let r=e.filter(e=>e.id===t),i=e.filter(e=>e.id!==t),o=i.filter(e=>e.verification?.status==="verified"),a=i.filter(e=>!!e.verification?.status&&e.verification?.status!=="verified"),l=i.filter(e=>!e.verification.status);return o.sort((e,t)=>e.id.localeCompare(t.id)),a.sort((e,t)=>e.verification?.expireAt&&t.verification?.expireAt?e.verification.expireAt.getTime()-t.verification.expireAt.getTime():0),[...r,...o,...a,...l]}var Y=r(9140);let q=e=>{let{close:t}=(0,C.XC)();return(0,i.tZ)(R,{onSuccess:t,onReset:t,...e})},j=e=>{let{close:t}=(0,C.XC)();return(0,i.tZ)(Y._,{onSuccess:t,onReset:t,...e})},V=({shouldAllowCreation:e=!0})=>{let{user:t}=(0,g.aF)();return(0,i.tZ)(P.zd.Root,{title:(0,d.localizationKeys)("userProfile.start.emailAddressesSection.title"),centered:!1,id:"emailAddresses",children:(0,i.tZ)(S.a.Root,{children:(0,i.BX)(P.zd.ItemList,{id:"emailAddresses",children:[U(t?.emailAddresses,t?.primaryEmailAddressId).map(e=>{let r=e.id;return(0,i.BX)(o.Fragment,{children:[(0,i.BX)(P.zd.Item,{id:"emailAddresses",children:[(0,i.BX)(d.Flex,{sx:e=>({overflow:"hidden",gap:e.space.$1}),children:[(0,i.tZ)(d.Text,{sx:e=>({color:e.colors.$colorText}),truncate:!0,children:e.emailAddress}),t?.primaryEmailAddressId===r&&(0,i.tZ)(d.Badge,{localizationKey:(0,d.localizationKeys)("badge__primary")}),"verified"!==e.verification.status&&(0,i.tZ)(d.Badge,{localizationKey:(0,d.localizationKeys)("badge__unverified")})]}),(0,i.tZ)(H,{email:e})]}),(0,i.tZ)(S.a.Open,{value:`remove-${r}`,children:(0,i.tZ)(S.a.Card,{variant:"destructive",children:(0,i.tZ)(q,{emailId:r})})}),(0,i.tZ)(S.a.Open,{value:`verify-${r}`,children:(0,i.tZ)(S.a.Card,{children:(0,i.tZ)(j,{emailId:r})})})]},e.emailAddress)}),e&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(S.a.Trigger,{value:"add",children:(0,i.tZ)(P.zd.ArrowButton,{id:"emailAddresses",localizationKey:(0,d.localizationKeys)("userProfile.start.emailAddressesSection.primaryButton")})}),(0,i.tZ)(S.a.Open,{value:"add",children:(0,i.tZ)(S.a.Card,{children:(0,i.tZ)(j,{})})})]})]})})})},H=({email:e})=>{let t=(0,a.useCardState)(),{user:r}=(0,g.aF)(),{open:o}=(0,C.XC)(),l=e.id,n=r?.primaryEmailAddressId===l,s="verified"===e.verification.status,c=(0,g.WZ)(()=>r?.update({primaryEmailAddressId:l})),u=[n&&!s?{label:(0,d.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__primary"),onClick:()=>o(`verify-${l}`)}:null,!n&&s?{label:(0,d.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__nonPrimary"),onClick:()=>{c().catch(e=>(0,x.S3)(e,[],t.setError))}}:null,n||s?null:{label:(0,d.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__unverified"),onClick:()=>o(`verify-${l}`)},{label:(0,d.localizationKeys)("userProfile.start.emailAddressesSection.destructiveAction"),isDestructive:!0,onClick:()=>o(`remove-${l}`)}].filter(e=>null!==e);return(0,i.tZ)(Z.a,{actions:u})},Q=()=>{let{user:e}=(0,g.aF)(),t=e?.enterpriseAccounts.filter(({enterpriseConnection:e})=>e?.active);return t?.length?(0,i.tZ)(P.zd.Root,{title:(0,d.localizationKeys)("userProfile.start.enterpriseAccountsSection.title"),id:"enterpriseAccounts",centered:!1,children:(0,i.tZ)(P.zd.ItemList,{id:"enterpriseAccounts",children:t.map(e=>(0,i.tZ)(G,{account:e},e.id))})}):null},G=({account:e})=>{let t=e.emailAddress,r=e?.enterpriseConnection?.name,o=e.verification?.error?.longMessage;return(0,i.BX)(P.zd.Item,{id:"enterpriseAccounts",sx:e=>({gap:e.space.$2,justifyContent:"start"}),children:[(0,i.tZ)(J,{account:e}),(0,i.tZ)(d.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,i.BX)(d.Flex,{gap:1,center:!0,children:[(0,i.tZ)(d.Text,{truncate:!0,colorScheme:"body",children:r}),(0,i.tZ)(d.Text,{truncate:!0,as:"span",colorScheme:"secondary",children:t?`• ${t}`:""}),o&&(0,i.tZ)(d.Badge,{colorScheme:"danger",localizationKey:(0,d.localizationKeys)("badge__requiresAction")})]})})]},e.id)},J=({account:e})=>{let{provider:t,enterpriseConnection:r}=e,o=t.replace(/(oauth_|saml_)/,"").trim(),a=r?.name??o,l={elementDescriptor:[d.descriptors.providerIcon],alt:a,sx:e=>({width:e.sizes.$4}),elementId:d.descriptors.enterpriseButtonsProviderIcon.setId(e.provider)};return r?.logoPublicUrl?(0,i.tZ)(d.Image,{...l,src:r.logoPublicUrl}):(0,i.tZ)(z.e_,{id:o,value:a,"aria-label":`${a}'s icon`,elementDescriptor:[d.descriptors.providerIcon,d.descriptors.providerInitialIcon],elementId:d.descriptors.providerInitialIcon.setId(o)})};var ee=r(431),et=r(9460),er=r(8487),ei=r(207);let eo=(0,a.withCardStateProvider)(e=>{let{phoneId:t,onSuccess:r,onReset:a}=e,{user:l}=(0,g.aF)(),n=o.useRef(l?.phoneNumbers.find(e=>e.id===t)),s=(0,z.a2)({defaultStep:+!!n.current});return(0,i.BX)(z.en,{...s.props,children:[(0,i.tZ)(ea,{resourceRef:n,title:(0,d.localizationKeys)("userProfile.phoneNumberPage.title"),onSuccess:s.nextStep,onReset:a}),(0,i.tZ)(el,{resourceRef:n,title:(0,d.localizationKeys)("userProfile.phoneNumberPage.verifyTitle"),onSuccess:r,onReset:a})]})}),ea=e=>{let{title:t,onSuccess:r,onReset:o,onUseExistingNumberClick:l,resourceRef:n}=e,s=(0,a.useCardState)(),{user:c}=(0,g.aF)(),u=(0,g.WZ)((e,t)=>e.createPhoneNumber(t)),h=(0,x.Yp)("phoneNumber","",{type:"tel",label:(0,d.localizationKeys)("formFieldLabel__phoneNumber"),isRequired:!0}),m=h.value.length>1&&c?.username!==h.value,p=!!c?.phoneNumbers?.length&&l,f=async e=>{if(e.preventDefault(),c)return u(c,{phoneNumber:h.value}).then(e=>{n.current=e,r()}).catch(e=>(0,x.S3)(e,[h],s.setError))};return(0,i.tZ)(er.Y,{headerTitle:t,gap:1,children:(0,i.BX)(ee.l.Root,{gap:4,onSubmit:f,children:[(0,i.tZ)(d.Text,{localizationKey:(0,d.localizationKeys)("userProfile.phoneNumberPage.infoText"),colorScheme:"secondary"}),(0,i.tZ)(ee.l.ControlRow,{elementId:h.id,children:(0,i.tZ)(ee.l.PhoneInput,{...h.props,autoFocus:!0})}),(0,i.BX)(d.Flex,{justify:p?"between":"end",children:[p&&(0,i.tZ)(d.Button,{variant:"ghost",localizationKey:(0,d.localizationKeys)("userProfile.mfaPhoneCodePage.backButton"),onClick:l}),(0,i.tZ)(et.A,{submitLabel:(0,d.localizationKeys)("userProfile.formButtonPrimary__add"),isDisabled:!m,onReset:o})]})]})})},el=e=>{let{title:t,onSuccess:r,resourceRef:o,onReset:a}=e;return(0,i.tZ)(er.Y,{headerTitle:t,headerSubtitle:(0,d.localizationKeys)("userProfile.phoneNumberPage.verifySubtitle",{identifier:o.current?.phoneNumber}),children:(0,i.tZ)(ei.H,{nextStep:r,identification:o.current,identifier:o.current?.phoneNumber,prepareVerification:o.current?.prepareVerification,onReset:a})})},en=e=>{let{close:t}=(0,C.XC)();return(0,i.tZ)(w,{onSuccess:t,onReset:t,...e})},es=e=>{let{close:t}=(0,C.XC)();return(0,i.tZ)(eo,{onSuccess:t,onReset:t,...e})},ec=({shouldAllowCreation:e=!0})=>{let{user:t}=(0,g.aF)(),r=!!t?.phoneNumbers?.length;return e||r?(0,i.tZ)(P.zd.Root,{centered:!1,title:(0,d.localizationKeys)("userProfile.start.phoneNumbersSection.title"),id:"phoneNumbers",children:(0,i.tZ)(S.a.Root,{children:(0,i.BX)(P.zd.ItemList,{id:"phoneNumbers",children:[U(t?.phoneNumbers,t?.primaryPhoneNumberId).map(e=>{let r=e.id;return(0,i.BX)(o.Fragment,{children:[(0,i.BX)(P.zd.Item,{id:"phoneNumbers",children:[(0,i.tZ)(d.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,i.BX)(d.Flex,{gap:2,center:!0,children:[(0,i.tZ)(d.Text,{sx:e=>({color:e.colors.$colorText}),children:(0,x.L_)(e.phoneNumber)}),t?.primaryPhoneNumberId===r&&(0,i.tZ)(d.Badge,{localizationKey:(0,d.localizationKeys)("badge__primary")}),"verified"!==e.verification.status&&(0,i.tZ)(d.Badge,{localizationKey:(0,d.localizationKeys)("badge__unverified")})]})}),(0,i.tZ)(ed,{phone:e})]}),(0,i.tZ)(S.a.Open,{value:`remove-${r}`,children:(0,i.tZ)(S.a.Card,{variant:"destructive",children:(0,i.tZ)(en,{phoneId:r})})}),(0,i.tZ)(S.a.Open,{value:`verify-${r}`,children:(0,i.tZ)(S.a.Card,{children:(0,i.tZ)(es,{phoneId:r})})})]},r)}),e&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(S.a.Trigger,{value:"add",children:(0,i.tZ)(P.zd.ArrowButton,{id:"phoneNumbers",localizationKey:(0,d.localizationKeys)("userProfile.start.phoneNumbersSection.primaryButton")})}),(0,i.tZ)(S.a.Open,{value:"add",children:(0,i.tZ)(S.a.Card,{children:(0,i.tZ)(es,{})})})]})]})})}):null},ed=({phone:e})=>{let t=(0,a.useCardState)(),{open:r}=(0,C.XC)(),{user:o}=(0,g.aF)(),l=e.id,n=(0,g.WZ)(t=>t.update({primaryPhoneNumberId:e.id}));if(!o)return null;let s=o.primaryPhoneNumberId===e.id,c="verified"===e.verification.status,u=[s&&!c?{label:(0,d.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__primary"),onClick:()=>r(`verify-${l}`)}:null,!s&&c?{label:(0,d.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__nonPrimary"),onClick:()=>n(o).catch(e=>(0,x.S3)(e,[],t.setError))}:null,s||c?null:{label:(0,d.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__unverified"),onClick:()=>r(`verify-${l}`)},{label:(0,d.localizationKeys)("userProfile.start.phoneNumbersSection.destructiveAction"),isDestructive:!0,onClick:()=>r(`remove-${l}`)}].filter(e=>null!==e);return(0,i.tZ)(Z.a,{actions:u})};var eu=r(1201);let eh=(0,a.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r}=e,{user:o}=(0,g.aF)(),l=(0,g.WZ)(e=>o?.update({username:e})),{userSettings:n}=(0,c.useEnvironment)(),s=(0,a.useCardState)(),{t:u,locale:h}=(0,d.useLocalizations)(),{usernameSettings:m}=n,p=(0,x.Yp)("username",o?.username||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__username"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__username"),buildErrorMessage:e=>(0,x.fq)(e,{t:u,locale:h,usernameSettings:m})});if(!o)return null;let f=n.attributes.username?.required,y=(!f||p.value.length>0)&&o.username!==p.value,v=async()=>{try{await l(p.value),t()}catch(e){(0,x.S3)(e,[p],s.setError)}};return(0,i.tZ)(er.Y,{headerTitle:o.username?(0,d.localizationKeys)("userProfile.usernamePage.title__update"):(0,d.localizationKeys)("userProfile.usernamePage.title__set"),children:(0,i.BX)(ee.l.Root,{onSubmit:v,children:[(0,i.tZ)(ee.l.ControlRow,{elementId:p.id,children:(0,i.tZ)(ee.l.PlainInput,{...p.props,autoFocus:!0,isRequired:f})}),(0,i.tZ)(et.A,{isDisabled:!y,onReset:r})]})})}),em=()=>{let{close:e}=(0,C.XC)();return(0,i.tZ)(eh,{onSuccess:e,onReset:e})},ep=()=>{let{user:e}=(0,g.aF)();return e?(0,i.tZ)(P.zd.Root,{title:(0,d.localizationKeys)("userProfile.start.usernameSection.title"),id:"username",sx:{alignItems:"center",[eu.mqu.md]:{alignItems:"flex-start"}},children:(0,i.BX)(S.a.Root,{children:[(0,i.tZ)(S.a.Closed,{value:"edit",children:(0,i.BX)(P.zd.Item,{id:"username",sx:{paddingLeft:e.username?void 0:"0"},children:[e.username&&(0,i.tZ)(d.Text,{truncate:!0,sx:e=>({color:e.colors.$colorText}),children:e.username}),(0,i.tZ)(S.a.Trigger,{value:"edit",children:(0,i.tZ)(P.zd.Button,{id:"username",localizationKey:e.username?(0,d.localizationKeys)("userProfile.start.usernameSection.primaryButton__updateUsername"):(0,d.localizationKeys)("userProfile.start.usernameSection.primaryButton__setUsername")})})]})}),(0,i.tZ)(S.a.Open,{value:"edit",children:(0,i.tZ)(S.a.Card,{children:(0,i.tZ)(em,{})})})]})}):null};var ef=r(7295),eg=r(3300),ey=r(6654),ev=r(5472);let eP=e=>{let{user:t,...r}=e;return(0,i.tZ)(ey.C,{...r,title:(0,h.u1)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,i.tZ)(ev.Y,{size:e=>e.sizes.$12,...t})})},eZ=(0,a.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r}=e,o=(0,a.useCardState)(),{user:l}=(0,g.aF)();if(!l)return null;let{first_name:n,last_name:s}=(0,c.useEnvironment)().userSettings.attributes,u=n?.enabled,h=s?.enabled,m=l.firstName||"",p=l.lastName||"",f=(0,x.Yp)("firstName",l.firstName||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__firstName"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__firstName"),isRequired:s?.required}),y=(0,x.Yp)("lastName",l.lastName||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__lastName"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__lastName"),isRequired:s?.required}),v=u&&f.value!==m||h&&y.value!==p,P=u&&n.required||h&&s.required,Z=P&&!!y.value&&!!f.value&&v,z=l.enterpriseAccounts.some(e=>e.active),S=async e=>(e.preventDefault(),(v?l.update({firstName:f.value,lastName:y.value}):Promise.resolve()).then(t).catch(e=>{(0,x.S3)(e,[f,y],o.setError)}));return(0,i.BX)(er.Y,{headerTitle:(0,d.localizationKeys)("userProfile.profilePage.title"),children:[z&&(0,i.tZ)(eg.e,{message:(0,d.localizationKeys)("userProfile.profilePage.readonly")}),(0,i.BX)(ee.l.Root,{onSubmit:S,sx:e=>({gap:e.space.$6}),children:[(0,i.tZ)(eP,{user:l,onAvatarChange:e=>l.setProfileImage({file:e}).then(()=>{o.setIdle()}).catch(e=>(0,x.S3)(e,[],o.setError)),onAvatarRemove:(0,b.QO)(l.imageUrl)?null:()=>{l.setProfileImage({file:null}).then(()=>{o.setIdle()}).catch(e=>(0,x.S3)(e,[],o.setError))}}),(u||h)&&(0,i.BX)(ee.l.ControlRow,{elementId:"name",children:[u&&(0,i.tZ)(ee.l.PlainInput,{...f.props,isDisabled:z,autoFocus:!0}),h&&(0,i.tZ)(ee.l.PlainInput,{...y.props,isDisabled:z,autoFocus:!u})]}),(0,i.tZ)(et.A,{isDisabled:P?!Z:!v,onReset:r})]})]})}),eb=()=>{let{close:e}=(0,C.XC)();return(0,i.tZ)(eZ,{onSuccess:e,onReset:e})},ez=()=>{let{user:e}=(0,g.aF)();if(!e)return null;let{username:t,primaryEmailAddress:r,primaryPhoneNumber:o,primaryWeb3Wallet:a,...l}=e;return(0,i.tZ)(P.zd.Root,{title:(0,d.localizationKeys)("userProfile.start.profileSection.title"),id:"profile",sx:{[eu.mqu.md]:{alignItems:"flex-start"}},children:(0,i.BX)(S.a.Root,{children:[(0,i.tZ)(S.a.Closed,{value:"edit",children:(0,i.BX)(P.zd.Item,{id:"profile",children:[(0,i.tZ)(ef.E,{user:l,size:"lg",mainIdentifierVariant:"subtitle",sx:e=>({color:e.colors.$colorText})}),(0,i.tZ)(S.a.Trigger,{value:"edit",children:(0,i.tZ)(P.zd.Button,{id:"profile",localizationKey:(0,d.localizationKeys)("userProfile.start.profileSection.primaryButton")})})]})}),(0,i.tZ)(S.a.Open,{value:"edit",children:(0,i.tZ)(S.a.Card,{children:(0,i.tZ)(eb,{})})})]})})};var eS=r(4101);let eC=(0,a.withCardStateProvider)(({onClick:e})=>{let t=(0,a.useCardState)(),{user:r}=(0,g.aF)(),{strategies:o,strategyToDisplayData:l}=(0,K.vO)(),n=o.filter(e=>e.startsWith("web3")),s=r?.verifiedWeb3Wallets.map(e=>e.verification.strategy),c=n.filter(e=>!s.includes(e)),u=(0,g.WZ)(e=>r?.createWeb3Wallet({web3Wallet:e})),h=async e=>{let i=e.replace("web3_","").replace("_signature","");t.setError(void 0);try{t.setLoading(e);let o=await (0,eS.Ly)({provider:i});if(!r)throw Error("user is not defined");let a=await u(o);a=await a?.prepareVerification({strategy:e});let l=a?.verification.message,n=await (0,eS.bQ)({identifier:o,nonce:l,provider:i});await a?.attemptVerification({signature:n}),t.setIdle()}catch(r){t.setIdle();let e=(0,x.zQ)(r);e?t.setError(e.longMessage):(0,x.S3)(r,[],t.setError)}};return 0===c.length?null:(0,i.BX)(i.HY,{children:[(0,i.tZ)(P.zd.ActionMenu,{id:"web3Wallets",triggerLocalizationKey:(0,d.localizationKeys)("userProfile.start.web3WalletsSection.primaryButton"),onClick:e,children:c.map(e=>(0,i.tZ)(P.zd.ActionMenuItem,{id:l[e].id,onClick:()=>h(e),isLoading:t.loadingMetadata===e,isDisabled:t.isLoading,localizationKey:(0,d.localizationKeys)("userProfile.web3WalletPage.web3WalletButtonsBlockButton",{provider:l[e].name}),sx:e=>({justifyContent:"start",gap:e.space.$2}),leftIcon:(0,i.tZ)(d.Image,{elementDescriptor:d.descriptors.providerIcon,elementId:d.descriptors.providerIcon.setId(l[e].id),isLoading:t.loadingMetadata===e,isDisabled:t.isLoading,src:l[e].iconUrl,alt:`Connect ${l[e].name}`,sx:e=>({width:e.sizes.$5})})},e))}),t.error&&(0,i.tZ)(d.Text,{colorScheme:"danger",sx:e=>({padding:e.sizes.$1x5,paddingLeft:e.sizes.$8x5}),children:t.error})]})}),eK=e=>{let{close:t}=(0,C.XC)();return(0,i.tZ)(I,{onSuccess:t,onReset:t,...e})},ex=e=>e.length<=10?e:e.slice(0,6)+"..."+e.slice(-4),e_=(0,a.withCardStateProvider)(({shouldAllowCreation:e=!0})=>{let{user:t}=(0,g.aF)(),r=(0,a.useCardState)(),{strategyToDisplayData:l}=(0,K.vO)(),n=!!t?.web3Wallets?.length,[s,c]=(0,o.useState)(null);return e||n?(0,i.BX)(P.zd.Root,{title:(0,d.localizationKeys)("userProfile.start.web3WalletsSection.title"),centered:!1,id:"web3Wallets",children:[(0,i.tZ)(y.Z.Alert,{children:r.error}),(0,i.BX)(S.a.Root,{value:s,onChange:c,children:[(0,i.tZ)(P.zd.ItemList,{id:"web3Wallets",children:U(t?.web3Wallets,t?.primaryWeb3WalletId).map(e=>{let r=e.verification.strategy,a=e.id;return l[r]&&(0,i.BX)(o.Fragment,{children:[(0,i.BX)(P.zd.Item,{id:"web3Wallets",align:"start",children:[(0,i.BX)(d.Flex,{sx:e=>({alignItems:"center",gap:e.space.$2,width:"100%"}),children:[l[r].iconUrl&&(0,i.tZ)(d.Image,{src:l[r].iconUrl,alt:l[r].name,sx:e=>({width:e.sizes.$4})}),(0,i.tZ)(d.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,i.BX)(d.Flex,{gap:2,justify:"start",children:[(0,i.BX)(d.Text,{children:[l[r].name," (",ex(e.web3Wallet),")"]}),t?.primaryWeb3WalletId===a&&(0,i.tZ)(d.Badge,{localizationKey:(0,d.localizationKeys)("badge__primary")}),"verified"!==e.verification.status&&(0,i.tZ)(d.Badge,{localizationKey:(0,d.localizationKeys)("badge__unverified")})]})})]}),(0,i.tZ)(eB,{walletId:a})]},a),(0,i.tZ)(S.a.Open,{value:`remove-${a}`,children:(0,i.tZ)(S.a.Card,{variant:"destructive",children:(0,i.tZ)(eK,{walletId:e.id})})})]},e.id)})}),e&&(0,i.tZ)(eC,{onClick:()=>c(null)})]})]}):null}),eB=({walletId:e})=>{let t=(0,a.useCardState)(),{open:r}=(0,C.XC)(),{user:o}=(0,g.aF)(),l=o?.primaryWeb3WalletId===e,n=(0,g.WZ)(()=>o?.update({primaryWeb3WalletId:e})),s=[l?null:{label:(0,d.localizationKeys)("userProfile.start.web3WalletsSection.detailsAction__nonPrimary"),onClick:()=>{n().catch(e=>(0,x.S3)(e,[],t.setError))}},{label:(0,d.localizationKeys)("userProfile.start.web3WalletsSection.destructiveAction"),isDestructive:!0,onClick:()=>r(`remove-${e}`)}].filter(e=>null!==e);return(0,i.tZ)(Z.a,{actions:s})},eR=(0,a.withCardStateProvider)(()=>{let{attributes:e,social:t,enterpriseSSO:r}=(0,c.useEnvironment)().userSettings,o=(0,a.useCardState)(),{user:l}=(0,g.aF)(),n=e.username?.enabled,s=e.email_address?.enabled,u=e.phone_number?.enabled,h=t&&Object.values(t).filter(e=>e.enabled).length>0,m=l&&r.enabled,p=e.web3_wallet?.enabled,f=!m||!l.enterpriseAccounts.some(e=>e.active&&e.enterpriseConnection?.disableAdditionalIdentifications);return(0,i.tZ)(d.Col,{elementDescriptor:d.descriptors.page,sx:e=>({gap:e.space.$8,color:e.colors.$colorText}),children:(0,i.BX)(d.Col,{elementDescriptor:d.descriptors.profilePage,elementId:d.descriptors.profilePage.setId("account"),children:[(0,i.tZ)(v.h.Root,{children:(0,i.tZ)(v.h.Title,{localizationKey:(0,d.localizationKeys)("userProfile.start.headerTitle__account"),sx:e=>({marginBottom:e.space.$4}),textVariant:"h2"})}),(0,i.tZ)(y.Z.Alert,{children:o.error}),(0,i.tZ)(ez,{}),n&&(0,i.tZ)(ep,{}),s&&(0,i.tZ)(V,{shouldAllowCreation:f}),u&&(0,i.tZ)(ec,{shouldAllowCreation:f}),h&&(0,i.tZ)(F,{shouldAllowCreation:f}),m&&(0,i.tZ)(Q,{}),p&&(0,i.tZ)(e_,{shouldAllowCreation:f})]})})});var ew=r(5006);let ek=()=>{let{navigate:e}=(0,u.useRouter)();return(0,i.BX)(i.HY,{children:[(0,i.tZ)(v.h.Root,{sx:e=>({borderBottomWidth:e.borderWidths.$normal,borderBottomStyle:e.borderStyles.$solid,borderBottomColor:e.colors.$neutralAlpha100,marginBlockEnd:e.space.$4,paddingBlockEnd:e.space.$4}),children:(0,i.tZ)(v.h.BackLink,{onClick:()=>void e("../",{searchParams:new URLSearchParams("tab=plans")}),children:(0,i.tZ)(v.h.Title,{localizationKey:(0,h.u1)("userProfile.plansPage.title"),textVariant:"h2"})})}),(0,i.tZ)(c.PricingTableContext.Provider,{value:{componentName:"PricingTable",mode:"modal"},children:(0,i.tZ)(ew.b,{})})]})},eI=()=>(0,i.tZ)(c.SubscriberTypeContext.Provider,{value:"user",children:(0,i.tZ)(ek,{})});var eT=r(8104),eA=r(6958);let eX=()=>{let{user:e}=(0,g.aF)(),{session:t}=(0,g.kP)(),{data:r,isLoading:o}=(0,K.ib)(e?.getSessions,"user-sessions");return(0,i.tZ)(P.zd.Root,{title:(0,d.localizationKeys)("userProfile.start.activeDevicesSection.title"),centered:!1,id:"activeDevices",children:(0,i.tZ)(P.zd.ItemList,{id:"activeDevices",disableAnimation:!0,children:o?(0,i.tZ)(eT.m,{}):r?.sort(O(t.id)).map(e=>eL(e.status)?i.tZ(e$,{session:e},e.id):null)})})},eL=e=>["active","pending"].includes(e),e$=({session:e})=>{let t=g.kP().session?.id===e.id,r=(0,K._m)(),o=(0,g.WZ)(e.revoke.bind(e)),a=async()=>{if(!t&&e)return r.setLoading(),o().catch(e=>(0,x.S3)(e,[],r.setError)).finally(()=>r.setIdle())};return(0,i.tZ)(P.zd.Item,{id:"activeDevices",elementDescriptor:d.descriptors.activeDeviceListItem,elementId:t?d.descriptors.activeDeviceListItem.setId("current"):void 0,sx:{alignItems:"flex-start",opacity:r.isLoading?.5:1},isDisabled:r.isLoading,children:(0,i.BX)(i.HY,{children:[(0,i.tZ)(eF,{session:e}),!t&&(0,i.tZ)(eE,{revoke:a})]})})},eF=e=>{let{session:t}=(0,g.kP)(),r=t?.id===e.session.id,o=!!t?.actor,a=!!e.session.actor,{city:l,country:n,browserName:s,browserVersion:c,deviceType:u,ipAddress:h,isMobile:m}=e.session.latestActivity,p=`${s||""} ${c||""}`.trim()||"Web browser",f=[l||"",n||""].filter(Boolean).join(", ").trim()||null,{t:y}=(0,d.useLocalizations)();return(0,i.BX)(d.Flex,{elementDescriptor:d.descriptors.activeDevice,elementId:r?d.descriptors.activeDevice.setId("current"):void 0,sx:e=>({width:"100%",overflow:"hidden",gap:e.space.$4,[eu.mqu.sm]:{gap:e.space.$2}}),children:[(0,i.tZ)(d.Flex,{sx:e=>({[eu.mqu.sm]:{padding:"0"},borderRadius:e.radii.$md}),children:(0,i.tZ)(d.Icon,{elementDescriptor:d.descriptors.activeDeviceIcon,elementId:d.descriptors.activeDeviceIcon.setId(m?"mobile":"desktop"),icon:m?eA.Fh:eA.eu,sx:e=>({"--cl-chassis-bottom":"#444444","--cl-chassis-back":"#343434","--cl-chassis-screen":"#575757","--cl-screen":"#000000",width:e.space.$8,height:e.space.$8})})}),(0,i.BX)(d.Col,{align:"start",gap:1,children:[(0,i.BX)(d.Flex,{center:!0,gap:2,children:[(0,i.tZ)(d.Text,{children:u||(m?"Mobile device":"Desktop device")}),r&&(0,i.tZ)(d.Badge,{localizationKey:(0,d.localizationKeys)("badge__thisDevice"),colorScheme:o?"danger":"primary"}),o&&!a&&(0,i.tZ)(d.Badge,{localizationKey:(0,d.localizationKeys)("badge__userDevice")}),!r&&a&&(0,i.tZ)(d.Badge,{localizationKey:(0,d.localizationKeys)("badge__otherImpersonatorDevice"),colorScheme:"danger"})]}),(0,i.tZ)(d.Text,{colorScheme:"secondary",children:p}),(0,i.BX)(d.Text,{colorScheme:"secondary",children:[h," (",f,")"]}),(0,i.tZ)(d.Text,{colorScheme:"secondary",children:y((0,x.Qg)(e.session.lastActiveAt))})]})]})},eE=({revoke:e})=>{let t=[{label:(0,d.localizationKeys)("userProfile.start.activeDevicesSection.destructiveAction"),isDestructive:!0,onClick:e}].filter(e=>null!==e);return(0,i.tZ)(Z.a,{actions:t})};var eD=r(4264);let eO=(0,a.withCardStateProvider)(e=>{let{onReset:t}=e,r=(0,a.useCardState)(),{afterSignOutUrl:o,afterMultiSessionSingleSignOutUrl:l}=(0,c.useSignOutContext)(),{user:n}=(0,g.aF)(),{t:s}=(0,d.useLocalizations)(),{otherSessions:u}=(0,eD.j)({user:n}),{setActive:h}=(0,g.cL)(),m=(0,g.WZ)(()=>n?.delete()),p=(0,x.Yp)("deleteConfirmation","",{type:"text",label:(0,d.localizationKeys)("userProfile.deletePage.actionDescription"),isRequired:!0,placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__confirmDeletionUserAccount")}),f=p.value===(s((0,d.localizationKeys)("formFieldInputPlaceholder__confirmDeletionUserAccount"))||"Delete account"),y=async()=>{if(f)try{await m();let e=0===u.length?o:l;return await h({session:null,redirectUrl:e})}catch(e){(0,x.S3)(e,[],r.setError)}};return(0,i.tZ)(er.Y,{headerTitle:(0,d.localizationKeys)("userProfile.deletePage.title"),sx:e=>({gap:e.space.$0x5}),children:(0,i.BX)(ee.l.Root,{onSubmit:y,children:[(0,i.BX)(d.Col,{gap:1,children:[(0,i.tZ)(d.Text,{colorScheme:"secondary",localizationKey:(0,d.localizationKeys)("userProfile.deletePage.messageLine1")}),(0,i.tZ)(d.Text,{colorScheme:"danger",localizationKey:(0,d.localizationKeys)("userProfile.deletePage.messageLine2")})]}),(0,i.tZ)(ee.l.ControlRow,{elementId:p.id,children:(0,i.tZ)(ee.l.PlainInput,{...p.props,ignorePasswordManager:!0})}),(0,i.tZ)(et.A,{submitLabel:(0,d.localizationKeys)("userProfile.deletePage.confirm"),colorScheme:"danger",isDisabled:!f,onReset:t})]})})}),eN=()=>{let{close:e}=(0,C.XC)();return(0,i.tZ)(eO,{onSuccess:e,onReset:e})},eW=()=>(0,i.tZ)(P.zd.Root,{title:(0,d.localizationKeys)("userProfile.start.dangerSection.title"),id:"danger",sx:{alignItems:"center",[eu.mqu.md]:{alignItems:"flex-start"}},children:(0,i.BX)(S.a.Root,{children:[(0,i.tZ)(S.a.Closed,{value:"delete",children:(0,i.tZ)(P.zd.Item,{id:"danger",sx:e=>({paddingLeft:e.space.$1}),children:(0,i.tZ)(S.a.Trigger,{value:"delete",children:(0,i.tZ)(P.zd.Button,{id:"danger",variant:"ghost",colorScheme:"danger",localizationKey:(0,d.localizationKeys)("userProfile.start.dangerSection.deleteAccountButton")})})})}),(0,i.tZ)(S.a.Open,{value:"delete",children:(0,i.tZ)(S.a.Card,{variant:"destructive",children:(0,i.tZ)(eN,{})})})]})});var eM=r(5994),eU=r(3531),eY=r(5878);let eq=e=>{let{code:t}=e;return(0,i.tZ)(d.Flex,{center:!0,sx:e=>({padding:`${e.space.$1} ${e.space.$4}`}),children:(0,i.tZ)(d.Text,{children:t})})},ej=e=>{let{subtitle:t,backupCodes:r}=e,{applicationName:o}=(0,c.useEnvironment)().displayConfig,{user:a}=(0,g.aF)(),{print:l,printableProps:n}=(0,z.Qz)(),{onCopy:s,hasCopied:u}=(0,K.VP)(r?.join(",")||"");if(!a)return null;let h=(0,eY.xC)(a);return r?(0,i.BX)(i.HY,{children:[(0,i.BX)(d.Col,{gap:1,children:[(0,i.tZ)(d.Text,{localizationKey:(0,d.localizationKeys)("userProfile.backupCodePage.title__codelist"),variant:"subtitle"}),(0,i.tZ)(d.Text,{localizationKey:t,variant:"caption",colorScheme:"secondary"})]}),(0,i.BX)(d.Box,{sx:e=>({borderWidth:e.borderWidths.$normal,borderStyle:e.borderStyles.$solid,borderColor:e.colors.$neutralAlpha100,borderRadius:e.radii.$lg}),children:[(0,i.tZ)(d.Grid,{gap:2,sx:e=>({gridTemplateColumns:`repeat(2, minmax(${e.sizes.$12}, 1fr))`,padding:`${e.space.$4} ${e.space.$6}`}),children:r.map((e,t)=>(0,i.tZ)(eq,{code:e},t))}),(0,i.BX)(d.Grid,{sx:e=>({borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,gridTemplateColumns:"repeat(3, minmax(0, 1fr))",">:not([hidden])~:not([hidden])":{borderRightWidth:"0px",borderLeftWidth:"1px",borderStyle:"solid",borderColor:e.colors.$neutralAlpha100},">:first-child":{borderBottomLeftRadius:e.radii.$lg},">:last-child":{borderBottomRightRadius:e.radii.$lg}}),children:[(0,i.tZ)(d.Button,{variant:"ghost",sx:e=>({width:"100%",padding:`${e.space.$2} 0`,borderRadius:0}),onClick:()=>{let e=document.createElement("a"),t=new Blob([function(e,t,r){let i=e?.join("\n");return`These are your backup codes for ${t} account ${r}.
Store them securely and keep them secret. Each code can only be used once.

${i}`}(r,o,h)],{type:"text/plain"});e.href=URL.createObjectURL(t),e.download=`${o}_backup_codes.txt`,document.body.appendChild(e),e.click()},children:(0,i.tZ)(d.Icon,{icon:eA.UW})}),(0,i.tZ)(d.Button,{variant:"ghost",sx:e=>({width:"100%",padding:`${e.space.$2} 0`,borderRadius:0}),onClick:l,children:(0,i.tZ)(d.Icon,{icon:eA.Kh})}),(0,i.tZ)(d.Button,{variant:"ghost",onClick:s,sx:e=>({width:"100%",padding:`${e.space.$2} 0`,borderRadius:0}),children:(0,i.tZ)(d.Icon,{icon:u?eA.Jr:eA.CK})})]})]}),(0,i.BX)(z.o4,{...n,children:[(0,i.BX)(d.Heading,{children:["Your backup codes for ",o," account ",h,":"]}),(0,i.tZ)(d.Col,{gap:2,children:r.map((e,t)=>(0,i.tZ)(eq,{code:e},t))})]})]}):null},eV=(0,a.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r}=e,{user:l}=(0,g.aF)(),n=(0,a.useCardState)(),s=(0,g.WZ)(()=>l?.createBackupCode()),[c,u]=o.useState(void 0);return(o.useEffect(()=>{!c&&l&&s().then(e=>u(e)).catch(e=>{if((0,eU.mh)(e))return r();(0,x.S3)(e,[],n.setError)})},[]),n.error)?(0,i.tZ)(er.Y,{headerTitle:(0,d.localizationKeys)("userProfile.backupCodePage.title")}):(0,i.tZ)(er.Y,{headerTitle:(0,d.localizationKeys)("userProfile.backupCodePage.title"),children:c?(0,i.BX)(i.HY,{children:[(0,i.tZ)(d.Text,{localizationKey:(0,d.localizationKeys)("userProfile.backupCodePage.successMessage")}),(0,i.tZ)(ej,{subtitle:(0,d.localizationKeys)("userProfile.backupCodePage.subtitle__codelist"),backupCodes:c.codes}),(0,i.tZ)(et.K,{children:(0,i.tZ)(d.Button,{autoFocus:!0,onClick:t,localizationKey:(0,d.localizationKeys)("userProfile.formButtonPrimary__finish"),elementDescriptor:d.descriptors.formButtonPrimary})})]}):(0,i.tZ)(eT.m,{})})}),eH=(0,a.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r}=e,o=(0,z.a2)();return(0,i.BX)(z.en,{...o.props,children:[(0,i.tZ)(eQ,{onContinue:o.nextStep}),(0,i.tZ)(eV,{onSuccess:t,onReset:r})]})}),eQ=e=>{let{onContinue:t}=e,{close:r}=(0,C.XC)();return(0,i.BX)(er.Y,{headerTitle:(0,d.localizationKeys)("userProfile.backupCodePage.title"),children:[(0,i.tZ)(d.Text,{localizationKey:(0,d.localizationKeys)("userProfile.backupCodePage.infoText1")}),(0,i.tZ)(d.Text,{localizationKey:(0,d.localizationKeys)("userProfile.backupCodePage.infoText2")}),(0,i.BX)(et.K,{sx:{marginTop:0},children:[(0,i.tZ)(d.Button,{textVariant:"buttonSmall",onClick:t,localizationKey:(0,d.localizationKeys)("userProfile.formButtonPrimary__finish"),elementDescriptor:d.descriptors.formButtonPrimary}),(0,i.tZ)(d.Button,{variant:"ghost",onClick:r,localizationKey:(0,d.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:d.descriptors.formButtonReset})]})]})};var eG=r(3412),eJ=r(7263);let e0=(0,a.withCardStateProvider)(e=>{let{onReset:t,onSuccess:r}=e,a=o.useRef(),l=(0,z.a2)({defaultStep:2}),n=c.useEnvironment().userSettings.attributes.backup_code?.enabled;return(0,i.BX)(z.en,{...l.props,children:[(0,i.tZ)(ea,{title:(0,d.localizationKeys)("userProfile.phoneNumberPage.title"),resourceRef:a,onSuccess:l.nextStep,onUseExistingNumberClick:()=>l.goToStep(2),onReset:t}),(0,i.tZ)(e3,{title:(0,d.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:a,onSuccess:()=>n?l.goToStep(3):r(),onReset:()=>l.goToStep(2)}),(0,i.tZ)(e2,{onSuccess:n?l.nextStep:r,onReset:t,onAddPhoneClick:()=>l.goToStep(0),onUnverifiedPhoneClick:e=>{a.current=e,l.goToStep(1)},title:(0,d.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:a}),n&&(0,i.tZ)(eJ.I,{title:(0,d.localizationKeys)("userProfile.mfaPhoneCodePage.successTitle"),text:a.current?.backupCodes&&a.current?.backupCodes.length>0?[(0,d.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage1"),(0,d.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage2")]:[(0,d.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage1")],onFinish:t,contents:(0,i.tZ)(ej,{backupCodes:a.current?.backupCodes})})]})}),e1=e=>{let{phone:t,onSuccess:r,onUnverifiedPhoneClick:o,resourceRef:l}=e,n=(0,a.useCardState)(),s=(0,g.WZ)(()=>t.setReservedForSecondFactor({reserved:!0})),{country:c}=(0,x.Z_)(t.phoneNumber),u=(0,x.L_)(t.phoneNumber),h=async()=>{if("verified"!==t.verification.status)return o(t);n.setLoading(t.id);try{await s(),l.current=t,r()}catch(e){(0,x.S3)(e,[],n.setError)}finally{n.setIdle()}};return(0,i.BX)(d.Button,{variant:"outline",colorScheme:"neutral",sx:{justifyContent:"start"},onClick:h,isLoading:n.loadingMetadata===t.id,isDisabled:n.isLoading,children:[c.iso.toUpperCase()," ",u]},t.id)},e3=e=>{let{title:t,onSuccess:r,resourceRef:o,onReset:l}=e,n=(0,a.useCardState)(),s=o.current,c=(0,g.WZ)(()=>s?.setReservedForSecondFactor({reserved:!0})),u=async()=>{n.setLoading(s?.id);try{await c(),o.current=s,r()}catch(e){(0,x.S3)(e,[],n.setError)}finally{n.setIdle()}};return(0,i.tZ)(er.Y,{headerTitle:t,headerSubtitle:(0,d.localizationKeys)("userProfile.phoneNumberPage.verifySubtitle",{identifier:o.current?.phoneNumber}),children:(0,i.tZ)(ei.H,{nextStep:()=>{u()},identification:o.current,identifier:o.current?.phoneNumber,prepareVerification:o.current?.prepareVerification,onReset:l})})},e2=e=>{let{onSuccess:t,onReset:r,title:o,onAddPhoneClick:a,onUnverifiedPhoneClick:l,resourceRef:n}=e,{user:s}=(0,g.aF)();if(!s)return null;let c=s.phoneNumbers.filter(e=>!e.reservedForSecondFactor);return(0,i.BX)(er.Y,{headerTitle:o,gap:1,children:[(0,i.tZ)(d.Text,{localizationKey:(0,d.localizationKeys)(c.length?"userProfile.mfaPhoneCodePage.subtitle__availablePhoneNumbers":"userProfile.mfaPhoneCodePage.subtitle__unavailablePhoneNumbers"),colorScheme:"secondary"}),c.length>0&&(0,i.tZ)(d.Col,{gap:2,children:c.map(e=>(0,i.tZ)(e1,{onSuccess:t,phone:e,onUnverifiedPhoneClick:l,resourceRef:n},e.id))}),(0,i.BX)(et.K,{sx:{flexDirection:"row",justifyContent:"space-between"},children:[(0,i.tZ)(eG.h,{variant:"ghost","aria-label":"Add phone number",icon:(0,i.tZ)(d.Icon,{icon:eA.v3,sx:e=>({marginRight:e.space.$2})}),localizationKey:(0,d.localizationKeys)("userProfile.mfaPhoneCodePage.primaryButton__addPhoneNumber"),onClick:a}),(0,i.tZ)(d.Button,{variant:"ghost",localizationKey:(0,d.localizationKeys)("userProfile.formButtonReset"),onClick:r})]})]})};var e4=r(8864);let e9=(0,a.withCardStateProvider)(e=>{let{title:t,onSuccess:r,onReset:l}=e,{user:n}=(0,g.aF)(),s=(0,a.useCardState)(),c=(0,g.WZ)(()=>n?.createTOTP()),{close:u}=(0,C.XC)(),[h,m]=o.useState(void 0),[p,f]=o.useState("qr");return(o.useEffect(()=>{n&&c().then(e=>m(e)).catch(e=>(0,eU.uX)(e)&&"reverification_cancelled"===e.code?u():(0,x.S3)(e,[],s.setError))},[]),s.error)?(0,i.tZ)(er.Y,{headerTitle:t}):(0,i.BX)(er.Y,{headerTitle:t,headerSubtitle:"qr"==p?(0,d.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.infoText__ableToScan"):(0,d.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.infoText__unableToScan"),children:[!h&&(0,i.tZ)(eT.m,{}),h&&(0,i.BX)(i.HY,{children:[(0,i.BX)(d.Col,{gap:4,children:["qr"==p&&(0,i.tZ)(z.s_,{justify:"center",url:h.uri||""}),"uri"==p&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(d.Text,{colorScheme:"secondary",localizationKey:(0,d.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.inputLabel__unableToScan1")}),(0,i.tZ)(e4.D,{value:h.secret}),(0,i.tZ)(d.Text,{colorScheme:"secondary",localizationKey:(0,d.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.inputLabel__unableToScan2")}),(0,i.tZ)(e4.D,{value:h.uri})]})]}),(0,i.BX)(d.Flex,{justify:"between",align:"center",sx:{width:"100%"},children:["qr"==p&&(0,i.tZ)(d.Button,{variant:"link",textVariant:"buttonLarge",onClick:()=>f("uri"),localizationKey:(0,d.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.buttonUnableToScan__nonPrimary")}),"uri"==p&&(0,i.tZ)(d.Button,{variant:"link",textVariant:"buttonLarge",onClick:()=>f("qr"),localizationKey:(0,d.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.buttonAbleToScan__nonPrimary")}),(0,i.BX)(et.K,{children:[(0,i.tZ)(d.Button,{onClick:r,localizationKey:(0,d.localizationKeys)("userProfile.formButtonPrimary__continue"),elementDescriptor:d.descriptors.formButtonPrimary}),(0,i.tZ)(d.Button,{variant:"ghost",onClick:l,localizationKey:(0,d.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:d.descriptors.formButtonReset})]})]})]})]})});var e5=r(2667);let e6=(0,a.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r,resourceRef:o}=e,{user:a}=(0,g.aF)(),l=(0,e5.e3)({onCodeEntryFinished:(e,t,r)=>{a?.verifyTOTP({code:e}).then(e=>t(e)).catch(r)},onResolve:e=>{o.current=e,t()}});return(0,i.BX)(er.Y,{headerTitle:(0,d.localizationKeys)("userProfile.mfaTOTPPage.title"),children:[(0,i.tZ)(d.Col,{children:(0,i.tZ)(ee.l.OTPInput,{...l,label:(0,d.localizationKeys)("userProfile.mfaTOTPPage.verifyTitle"),description:(0,d.localizationKeys)("userProfile.mfaTOTPPage.verifySubtitle")})}),(0,i.tZ)(et.K,{sx:{marginTop:0},children:(0,i.tZ)(d.Button,{onClick:r,variant:"ghost",isDisabled:l.isLoading,localizationKey:(0,d.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:d.descriptors.formButtonReset})})]})}),e7=(0,a.withCardStateProvider)(e=>{let{onReset:t}=e,r=(0,z.a2)(),a=o.useRef();return(0,i.BX)(z.en,{...r.props,children:[(0,i.tZ)(e9,{title:(0,d.localizationKeys)("userProfile.mfaTOTPPage.title"),onSuccess:r.nextStep,onReset:t}),(0,i.tZ)(e6,{onSuccess:r.nextStep,onReset:t,resourceRef:a}),(0,i.tZ)(eJ.I,{title:(0,d.localizationKeys)("userProfile.mfaTOTPPage.title"),text:(0,d.localizationKeys)("userProfile.mfaTOTPPage.successMessage"),onFinish:t,contents:(0,i.tZ)(ej,{subtitle:(0,d.localizationKeys)("userProfile.backupCodePage.successSubtitle"),backupCodes:a.current?.backupCodes})})]})}),e8=(0,a.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r,selectedStrategy:l}=e,n=(0,a.useCardState)(),{userSettings:{attributes:s}}=(0,c.useEnvironment)(),{user:u}=(0,g.aF)();if(!u)return null;let h=(0,d.localizationKeys)("userProfile.mfaPage.title"),m=o.useMemo(()=>M(s,u),[]);return(o.useEffect(()=>{0===m.length&&n.setError("There are no second factors available to add")},[]),n.error)?(0,i.tZ)(er.Y,{headerTitle:h}):0!==m.length||l?(0,i.tZ)(te,{onSuccess:t,onReset:r,method:l||m[0]}):null}),te=e=>{let{method:t,onSuccess:r,onReset:o}=e;switch(t){case"phone_code":return(0,i.tZ)(e0,{onSuccess:r,onReset:o});case"totp":return(0,i.tZ)(e7,{onSuccess:r,onReset:o});case"backup_code":return(0,i.tZ)(eH,{onSuccess:r,onReset:o});default:return null}},tt=()=>{let{close:e}=(0,C.XC)();return(0,i.tZ)(A,{onSuccess:e,onReset:e})},tr=e=>{let{close:t}=(0,C.XC)();return(0,i.tZ)(T,{onSuccess:t,onReset:t,...e})},ti=()=>{let{close:e}=(0,C.XC)();return(0,i.tZ)(eV,{onSuccess:e,onReset:e})},to=e=>{let{close:t}=(0,C.XC)();return(0,i.tZ)(e8,{onSuccess:t,onReset:t,selectedStrategy:e.selectedStrategy})},ta=()=>{let{userSettings:{attributes:e}}=(0,c.useEnvironment)(),{user:t}=(0,g.aF)(),[r,a]=(0,o.useState)(null);if(!t)return null;let l=W(e),n=M(e,t),s=l.includes("totp")&&t.totpEnabled,u=l.includes("backup_code")&&t.backupCodeEnabled,h=t.phoneNumbers.filter(e=>"verified"===e.verification.status).filter(e=>e.reservedForSecondFactor).sort(N);return(0,i.tZ)(P.zd.Root,{title:(0,d.localizationKeys)("userProfile.start.mfaSection.title"),centered:!1,id:"mfa",children:(0,i.tZ)(S.a.Root,{value:r,onChange:a,children:(0,i.BX)(P.zd.ItemList,{id:"mfa",children:[s&&(0,i.BX)(i.HY,{children:[(0,i.BX)(P.zd.Item,{id:"mfa",hoverable:!0,children:[(0,i.BX)(d.Flex,{sx:e=>({gap:e.space.$2,alignItems:"center"}),children:[(0,i.tZ)(d.Icon,{icon:eA.hc,sx:e=>({color:e.colors.$neutralAlpha700})}),(0,i.tZ)(d.Text,{localizationKey:(0,d.localizationKeys)("userProfile.start.mfaSection.totp.headerTitle")}),(0,i.tZ)(d.Badge,{localizationKey:(0,d.localizationKeys)("badge__default")})]}),(0,i.tZ)(ts,{})]}),(0,i.tZ)(S.a.Open,{value:"remove-totp",children:(0,i.tZ)(S.a.Card,{variant:"destructive",children:(0,i.tZ)(tt,{})})})]}),l.includes("phone_code")&&h.map(e=>{let t=!s&&e.defaultSecondFactor,r=e.id;return(0,i.BX)(o.Fragment,{children:[(0,i.BX)(P.zd.Item,{id:"mfa",hoverable:!0,children:[(0,i.BX)(d.Flex,{sx:e=>({gap:e.space.$2,alignItems:"center"}),children:[(0,i.tZ)(d.Icon,{icon:eA.ij,sx:e=>({color:e.colors.$neutralAlpha700})}),(0,i.BX)(d.Text,{children:["SMS Code ",(0,i.tZ)(eM.q,{value:e.phoneNumber})]}),t&&(0,i.tZ)(d.Badge,{localizationKey:(0,d.localizationKeys)("badge__default")})]}),(0,i.tZ)(tl,{phone:e,showTOTP:s})]}),(0,i.tZ)(S.a.Open,{value:`remove-${r}`,children:(0,i.tZ)(S.a.Card,{variant:"destructive",children:(0,i.tZ)(tr,{phoneId:r})})})]},r)}),u&&(0,i.BX)(i.HY,{children:[(0,i.BX)(P.zd.Item,{id:"mfa",hoverable:!0,children:[(0,i.BX)(d.Flex,{sx:e=>({gap:e.space.$2,alignItems:"center"}),children:[(0,i.tZ)(d.Icon,{icon:eA.Qi,sx:e=>({color:e.colors.$neutralAlpha700})}),(0,i.tZ)(d.Text,{localizationKey:(0,d.localizationKeys)("userProfile.start.mfaSection.backupCodes.headerTitle")})]}),(0,i.tZ)(tn,{})]}),(0,i.tZ)(S.a.Open,{value:"regenerate",children:(0,i.tZ)(S.a.Card,{children:(0,i.tZ)(ti,{})})})]}),(0,i.tZ)(tc,{secondFactorsAvailableToAdd:n,onClick:()=>a(null)})]})})})},tl=({phone:e,showTOTP:t})=>{let{open:r}=(0,C.XC)(),o=(0,a.useCardState)(),l=e.id,n=[t||e.defaultSecondFactor?null:{label:(0,d.localizationKeys)("userProfile.start.mfaSection.phoneCode.actionLabel__setDefault"),onClick:()=>e.makeDefaultSecondFactor().catch(e=>(0,x.S3)(e,[],o.setError))},{label:(0,d.localizationKeys)("userProfile.start.mfaSection.phoneCode.destructiveActionLabel"),isDestructive:!0,onClick:()=>r(`remove-${l}`)}].filter(e=>null!==e);return(0,i.tZ)(Z.a,{actions:n})},tn=()=>{let{open:e}=(0,C.XC)(),t=[{label:(0,d.localizationKeys)("userProfile.start.mfaSection.backupCodes.actionLabel__regenerate"),onClick:()=>e("regenerate")}].filter(e=>null!==e);return(0,i.tZ)(Z.a,{actions:t})},ts=()=>{let{open:e}=(0,C.XC)(),t=[{label:(0,d.localizationKeys)("userProfile.start.mfaSection.totp.destructiveActionTitle"),isDestructive:!0,onClick:()=>e("remove-totp")}].filter(e=>null!==e);return(0,i.tZ)(Z.a,{actions:t})},tc=e=>{let{open:t}=(0,C.XC)(),{secondFactorsAvailableToAdd:r,onClick:a}=e,[l,n]=(0,o.useState)(),s=o.useMemo(()=>r.map(e=>"phone_code"===e?{icon:eA.ij,text:"SMS code",key:"phone_code"}:"totp"===e?{icon:eA.hc,text:"Authenticator application",key:"totp"}:"backup_code"===e?{icon:eA.Qi,text:"Backup code",key:"backup_code"}:null).filter(e=>null!==e),[r]);return(0,i.BX)(i.HY,{children:[r.length>0&&(0,i.tZ)(S.a.Closed,{value:"multi-factor",children:(0,i.tZ)(P.zd.ActionMenu,{id:"mfa",triggerLocalizationKey:(0,d.localizationKeys)("userProfile.start.mfaSection.primaryButton"),onClick:a,children:s.map(e=>e&&(0,i.tZ)(P.zd.ActionMenuItem,{id:e.key,localizationKey:e.text,leftIcon:e.icon,onClick:()=>{n(e.key),t("multi-factor")}},e.key))})}),(0,i.tZ)(S.a.Open,{value:"multi-factor",children:(0,i.tZ)(S.a.Card,{children:l&&(0,i.tZ)(to,{selectedStrategy:l})})})]})},td=e=>{let{close:t}=(0,C.XC)();return(0,i.tZ)(X,{onSuccess:t,onReset:t,...e})},tu=e=>{let{close:t}=(0,C.XC)();return(0,i.tZ)(th,{onSuccess:t,onReset:t,passkey:e.passkey})},th=(0,a.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r,passkey:o}=e,l=(0,a.useCardState)(),n=(0,x.Yp)("passkeyName",o.name||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__passkeyName"),isRequired:!0}),s=n.value.length>1&&o.name!==n.value,c=async e=>(e.preventDefault(),o.update({name:n.value}).then(t).catch(e=>(0,x.S3)(e,[n],l.setError)));return(0,i.tZ)(er.Y,{headerTitle:(0,d.localizationKeys)("userProfile.passkeyScreen.title__rename"),headerSubtitle:(0,d.localizationKeys)("userProfile.passkeyScreen.subtitle__rename"),children:(0,i.BX)(ee.l.Root,{onSubmit:c,children:[(0,i.tZ)(ee.l.ControlRow,{elementId:n.id,children:(0,i.tZ)(ee.l.PlainInput,{...n.props,autoComplete:"off"})}),(0,i.tZ)(et.A,{submitLabel:(0,d.localizationKeys)("userProfile.formButtonPrimary__save"),isDisabled:!s,onReset:r})]})})}),tm=()=>{let{user:e}=(0,g.aF)(),[t,r]=(0,o.useState)(null);return e?(0,i.tZ)(P.zd.Root,{title:(0,d.localizationKeys)("userProfile.start.passkeysSection.title"),centered:!1,id:"passkeys",children:(0,i.tZ)(S.a.Root,{value:t,onChange:r,children:(0,i.BX)(P.zd.ItemList,{id:"passkeys",children:[e.passkeys.map(e=>{let t=e.id;return(0,i.BX)(o.Fragment,{children:[(0,i.tZ)(tp,{...e},t),(0,i.tZ)(S.a.Open,{value:`remove-${t}`,children:(0,i.tZ)(S.a.Card,{variant:"destructive",children:(0,i.tZ)(td,{passkey:e})})}),(0,i.tZ)(S.a.Open,{value:`rename-${t}`,children:(0,i.tZ)(S.a.Card,{children:(0,i.tZ)(tu,{passkey:e})})})]},t)}),(0,i.tZ)(ty,{onClick:()=>r(null)})]})})}):null},tp=e=>(0,i.BX)(P.zd.Item,{id:"passkeys",hoverable:!0,sx:{alignItems:"flex-start"},children:[(0,i.tZ)(tf,{...e}),(0,i.tZ)(tg,{passkey:e})]}),tf=e=>{let{name:t,createdAt:r,lastUsedAt:o}=e,{t:a}=(0,d.useLocalizations)();return(0,i.tZ)(d.Flex,{sx:e=>({width:"100%",overflow:"hidden",gap:e.space.$4,[eu.mqu.sm]:{gap:e.space.$2}}),children:(0,i.BX)(d.Col,{align:"start",gap:1,children:[(0,i.tZ)(d.Text,{children:t}),(0,i.BX)(d.Text,{colorScheme:"secondary",children:["Created: ",a((0,x.Qg)(r))]}),o&&(0,i.BX)(d.Text,{colorScheme:"secondary",children:["Last used: ",a((0,x.Qg)(o))]})]})})},tg=({passkey:e})=>{let{open:t}=(0,C.XC)(),r=e.id,o=[{label:(0,d.localizationKeys)("userProfile.start.passkeysSection.menuAction__rename"),onClick:()=>t(`rename-${r}`)},{label:(0,d.localizationKeys)("userProfile.start.passkeysSection.menuAction__destructive"),isDestructive:!0,onClick:()=>t(`remove-${r}`)}];return(0,i.tZ)(Z.a,{actions:o})},ty=({onClick:e})=>{let t=(0,a.useCardState)(),{isSatellite:r}=(0,g.cL)(),{user:o}=(0,g.aF)(),l=(0,g.WZ)(()=>o?.createPasskey()),n=async()=>{if(e?.(),o)try{await l()}catch(e){(0,x.S3)(e,[],t.setError)}};return r?null:(0,i.tZ)(P.zd.ArrowButton,{id:"passkeys",localizationKey:(0,d.localizationKeys)("userProfile.start.passkeysSection.primaryButton"),onClick:n})},tv=(e,t)=>{let r=[];return e?r.push((0,d.localizationKeys)("userProfile.passwordPage.successMessage__update")):r.push((0,d.localizationKeys)("userProfile.passwordPage.successMessage__set")),t&&r.push((0,d.localizationKeys)("userProfile.passwordPage.successMessage__signOutOfOtherSessions")),r},tP=(0,a.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r}=e,{user:l}=(0,g.aF)(),n=(0,g.WZ)((e,t)=>e.updatePassword(...t));if(!l)return null;let{userSettings:{passwordSettings:s},authConfig:{reverification:u}}=(0,c.useEnvironment)(),{session:h}=(0,g.kP)(),m=l.passwordEnabled?(0,d.localizationKeys)("userProfile.passwordPage.title__update"):(0,d.localizationKeys)("userProfile.passwordPage.title__set"),p=(0,a.useCardState)(),f=l.enterpriseAccounts.some(e=>e.active),y=l.passwordEnabled&&!u,v=(0,o.useRef)({title:(0,d.localizationKeys)("userProfile.passwordPage.title__set")}),P=(0,x.Yp)("currentPassword","",{type:"password",label:(0,d.localizationKeys)("formFieldLabel__currentPassword"),isRequired:!0}),Z=(0,x.Yp)("newPassword","",{type:"password",label:(0,d.localizationKeys)("formFieldLabel__newPassword"),isRequired:!0,validatePassword:!0,buildErrorMessage:e=>(0,x.GM)(e,{t:_,locale:B,passwordSettings:s})}),b=(0,x.Yp)("confirmPassword","",{type:"password",label:(0,d.localizationKeys)("formFieldLabel__confirmPassword"),isRequired:!0}),z=(0,x.Yp)("signOutOfOtherSessions","",{type:"checkbox",label:(0,d.localizationKeys)("formFieldLabel__signOutOfOtherSessions"),defaultChecked:!0}),{setConfirmPasswordFeedback:S,isPasswordMatch:C}=(0,K.p5)({passwordField:Z,confirmPasswordField:b}),{t:_,locale:B}=(0,d.useLocalizations)(),R=(y?P.value&&C:C)&&Z.value&&b.value,w=async()=>{try{v.current={title:l.passwordEnabled?(0,d.localizationKeys)("userProfile.passwordPage.title__update"):(0,d.localizationKeys)("userProfile.passwordPage.title__set"),text:tv(l.passwordEnabled,!!z.checked)};let e={newPassword:Z.value,signOutOfOtherSessions:z.checked,currentPassword:y?P.value:void 0};await n(l,[e]),t()}catch(e){(0,x.S3)(e,[P,Z,b],p.setError)}};return(0,i.BX)(er.Y,{headerTitle:m,children:[f&&(0,i.tZ)(eg.e,{message:(0,d.localizationKeys)("userProfile.passwordPage.readonly")}),(0,i.BX)(ee.l.Root,{onSubmit:w,onBlur:()=>{Z.value&&S(b.value)},children:[(0,i.tZ)("input",{readOnly:!0,"data-testid":"hidden-identifier",id:"identifier-field",name:"identifier",value:h?.publicUserData.identifier||"",style:{display:"none"}}),y&&(0,i.tZ)(ee.l.ControlRow,{elementId:P.id,children:(0,i.tZ)(ee.l.PasswordInput,{...P.props,minLength:6,isRequired:!0,autoFocus:!0,isDisabled:f})}),(0,i.tZ)(ee.l.ControlRow,{elementId:Z.id,children:(0,i.tZ)(ee.l.PasswordInput,{...Z.props,minLength:6,isRequired:!0,autoFocus:!l.passwordEnabled,isDisabled:f})}),(0,i.tZ)(ee.l.ControlRow,{elementId:b.id,children:(0,i.tZ)(ee.l.PasswordInput,{...b.props,onChange:e=>(e.target.value&&S(e.target.value),b.props.onChange(e)),isRequired:!0,isDisabled:f})}),(0,i.tZ)(ee.l.ControlRow,{elementId:z.id,children:(0,i.tZ)(ee.l.Checkbox,{...z.props,description:(0,d.localizationKeys)("userProfile.passwordPage.checkboxInfoText__signOutOfOtherSessions"),isDisabled:f})}),f?(0,i.tZ)(et.K,{children:(0,i.tZ)(ee.l.ResetButton,{localizationKey:(0,d.localizationKeys)("userProfile.formButtonReset"),block:!1,onClick:r})}):(0,i.tZ)(et.A,{isDisabled:!R,onReset:r})]})]})}),tZ=()=>{let{close:e}=(0,C.XC)();return(0,i.tZ)(tP,{onSuccess:e,onReset:e})},tb=()=>{let{user:e}=(0,g.aF)();if(!e)return null;let{passwordEnabled:t}=e;return(0,i.tZ)(P.zd.Root,{centered:!1,title:(0,d.localizationKeys)("userProfile.start.passwordSection.title"),id:"password",children:(0,i.BX)(S.a.Root,{children:[(0,i.tZ)(S.a.Closed,{value:"edit",children:(0,i.BX)(P.zd.Item,{id:"password",sx:e=>({paddingLeft:t?void 0:"0",paddingTop:e.space.$0x25,paddingBottom:e.space.$0x25}),children:[t&&(0,i.tZ)(d.Text,{variant:"h2",children:"••••••••••"}),(0,i.tZ)(S.a.Trigger,{value:"edit",children:(0,i.tZ)(P.zd.Button,{id:"password",localizationKey:t?(0,d.localizationKeys)("userProfile.start.passwordSection.primaryButton__updatePassword"):(0,d.localizationKeys)("userProfile.start.passwordSection.primaryButton__setPassword")})})]})}),(0,i.tZ)(S.a.Open,{value:"edit",children:(0,i.tZ)(S.a.Card,{children:(0,i.tZ)(tZ,{})})})]})})},tz=(0,a.withCardStateProvider)(()=>{let{attributes:e,instanceIsPasswordBased:t}=(0,c.useEnvironment)().userSettings,r=(0,a.useCardState)(),{user:o}=(0,g.aF)(),l=e.passkey?.enabled,n=W(e).length>0,s=o?.deleteSelfEnabled;return(0,i.tZ)(d.Col,{elementDescriptor:d.descriptors.page,sx:e=>({gap:e.space.$8}),children:(0,i.BX)(d.Col,{elementDescriptor:d.descriptors.profilePage,elementId:d.descriptors.profilePage.setId("security"),children:[(0,i.tZ)(v.h.Root,{children:(0,i.tZ)(v.h.Title,{localizationKey:(0,d.localizationKeys)("userProfile.start.headerTitle__security"),sx:e=>({marginBottom:e.space.$4}),textVariant:"h2"})}),(0,i.tZ)(y.Z.Alert,{children:r.error}),t&&(0,i.tZ)(tb,{}),l&&(0,i.tZ)(tm,{}),n&&(0,i.tZ)(ta,{}),(0,i.tZ)(eX,{}),s&&(0,i.tZ)(eW,{})]})})}),tS=(0,o.lazy)(()=>Promise.all([r.e("507"),r.e("200"),r.e("573"),r.e("82")]).then(r.bind(r,6793)).then(e=>({default:e.BillingPage}))),tC=()=>{let{pages:e}=(0,c.useUserProfileContext)(),{commerceSettings:t}=(0,c.useEnvironment)(),r=e.routes[0].id===s.xM.ACCOUNT,a=e.routes[0].id===s.xM.SECURITY,l=e.routes[0].id===s.xM.BILLING,n=e.contents?.map((e,t)=>{let o=!r&&!a&&0===t;return i.tZ(u.Route,{index:o,path:o?void 0:e.url,children:i.tZ(p.O,{mount:e.mount,unmount:e.unmount})},`custom-page-${e.url}`)});return(0,i.BX)(u.Switch,{children:[n,(0,i.BX)(u.Route,{children:[(0,i.tZ)(u.Route,{path:r?void 0:"account",children:(0,i.tZ)(u.Switch,{children:(0,i.tZ)(u.Route,{index:!0,children:(0,i.tZ)(eR,{})})})}),(0,i.tZ)(u.Route,{path:a?void 0:"security",children:(0,i.tZ)(u.Switch,{children:(0,i.tZ)(u.Route,{index:!0,children:(0,i.tZ)(tz,{})})})}),t.billing.enabled&&t.billing.hasPaidUserPlans&&(0,i.tZ)(u.Route,{path:l?void 0:"billing",children:(0,i.BX)(u.Switch,{children:[(0,i.tZ)(u.Route,{index:!0,children:(0,i.tZ)(o.Suspense,{fallback:"",children:(0,i.tZ)(tS,{})})}),(0,i.tZ)(u.Route,{path:"plans",children:(0,i.tZ)(o.Suspense,{fallback:"",children:(0,i.tZ)(eI,{})})}),(0,i.tZ)(u.Route,{path:"statement/:statementId",children:(0,i.tZ)(o.Suspense,{fallback:"",children:(0,i.tZ)(f.j,{})})})]})})]})]})};var tK=r(2786);let tx=(0,c.withCoreUserGuard)(()=>{let e=o.useRef(null);return(0,i.tZ)(n.P.Root,{children:(0,i.BX)(m,{contentRef:e,children:[(0,i.tZ)(l.ap,{navbarTitleLocalizationKey:(0,d.localizationKeys)("userProfile.navbar.title")}),(0,i.tZ)(n.P.Content,{contentRef:e,scrollBoxId:s.g8,children:(0,i.tZ)(tC,{})})]})})}),t_=(0,a.withCardStateProvider)(e=>(0,i.tZ)(d.Flow.Root,{flow:"userProfile",children:(0,i.tZ)(d.Flow.Part,{children:(0,i.BX)(u.Switch,{children:[(0,i.tZ)(u.Route,{path:"verify",children:(0,i.tZ)(tK.M,{})}),(0,i.tZ)(u.Route,{children:(0,i.tZ)(tx,{})})]})})})),tB=e=>{let t={...e,routing:"virtual",componentName:"UserProfile",mode:"modal"};return(0,i.tZ)(u.Route,{path:"user",children:(0,i.tZ)(c.UserProfileContext.Provider,{value:t,children:(0,i.tZ)("div",{children:(0,i.tZ)(t_,{...t})})})})}}}]);